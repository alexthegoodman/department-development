<!DOCTYPE html>
<html>
    <head>
        <title>App and API Versioning</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="bear-note-unique-identifier" content="B88E58F8-EB29-4B27-BA58-9F44774E36E3-27133-0000938DE50B59F4">
        <meta name="created" content="2017-11-11T13:22:41-0700"/>
        <meta name="modified" content="2018-03-12T07:09:17-0700"/>
        <meta name="tags" content="department/development/codesnippets, department, department/development, department/development/apps, department/development/backend/api, department/development/backend"/>
        <meta name="last device" content="Alex’s MacBook Air"/>
    </head>
    <body>
        <div class="note-wrapper">
            <h1 id="App and API Versioning">App and API Versioning</h1>
<p>There are many approaches to take.</p>
<br>
<ul><li>Separate instances for each version (different Heroku app)
<ul><li>	This is expensive and in-compatable with a highly iterative app (many releases 1.x.x)
</li><li>	Each Version has its own dependencies and environment configuration also - though old versions can be updated so long as its very small compatibility patches
</li></ul></li><li>Duplicate and alter root directory for each version, 1 instance
<ul><li>	This creates a ton of extra copies of files, since even endpoints that aren’t altered are duplicated in each <i>1.1.3</i> directory
</li><li>	But keeps the sub-directory structure as simple as now, and allows straightforward new versions.
</li></ul></li><li>Duplicate and alter each endpoint (organized with 1 endpoint per file), have all versions of it in the file
<ul><li>	<a href="https://www.npmjs.com/package/express-routes-versioning">https://www.npmjs.com/package/express-routes-versioning</a>
</li><li>	Overly complicated: commonly requires multi-level directories like <i>get</i>users<i>_______</i>______/ and may be more difficult to keep separate.
</li><li>	There is an appeal to deal with that one endpoint and see its history there
</li></ul>
</li></ul>
<br>
<ul><li>When to release new version - New API versions can be released on its own, or due to a new demand placed on by 1 of the apps (web, mobile, tv). The benefit is that those apps do not have to be updated by us or the consumer, thanks to have the old version available. This means that reliable use not only exists between app versions, but entirely separate apps as well. iOS v1.1 might use API v 1.2.3, while tvOS v1.4 might use API v1.7.2, while another user has an old version of tvOS v1.3.1 which is on API v 1.2.5.
<ul><li>	A version is needed due to new features, requirements, and architectures - not bug fixes
</li><li>	Does this mean that API versions must be large? One would not a directory like:
</li><li>	<i>1.1.1</i>
</li><li>	<i>1.1.2</i>
</li><li>	<i>1.1.3</i>
</li><li>	<i>1.1.4</i> - <b>so long as its the newest version, not in Live use, it need not be incremented. Increment upon the version’s first Live use.</b>
</li></ul></li><li>When to archive an old version - User analytics show that no apps are currently accessing that API. Show a warning message ahead of time.
</li><li>How does dependency updates affect all API versions?
<ul><li>	You could say that old versions are ONLY updated for dependency updates, not to change function or what’s needed, but small patches which do not change the actual version number. Yes.
</li><li>	Just be careful to update dependencies because it could break the whole chain. Ideally, old automated tests would be preserved as well.
</li></ul></li><li>What about changing the database?
<ul><li>	If changing the database, all versions will need to change. If an unlikely database re-design takes place, you should create a whole new instance.
<ul><li>		Save API version on each row, helps to detect needed on-the-fly updates / migrations
</li><li>		- But look into MongoDB and templated object shapes. Would be nice to update the shape for each version and perform the migration upon Heroku push.
</li></ul></li></ul></li><li>Public releases that require new things from the API should be rare. During the internal alpha stage, keep it all on 1.0.0 and make everybody update their Testflight app. Let them know that versioning will start upon public release, at which point the API should be updated in larger increments. (Perhaps monthly)
</li><li>A version is needed due to new features, requirements, and architectures - not bug fixes
</li><li>Update changeling file, consider auto-generated documentation (like more than Swagger? <a href="http://apidocjs.com/#preface">http://apidocjs.com/#preface</a> simpler and nice, although a Graph Explorer style interface would be nice as well <a href="https://www.npmjs.com/package/express-api-doc">https://www.npmjs.com/package/express-api-doc</a> ?)
</li></ul>
<br>
<p><a href='App%20and%20API%20Versioning/CA%20Technologies%20-%20OReilly%20Microservice%20Architecture%20eBook.pdf'>CA Technologies - OReilly Microservice Architecture eBook.pdf</a></p>
<br>
<p><span class='hashtag'>#department/development/codesnippets</span></p>
<p><span class='hashtag'>#department/development/apps</span></p>
<p><span class='hashtag'>#department/development/backend/api</span></p>
        </div>
        <script type="text/javascript">
            (function() {

    var doc_ols = document.getElementsByTagName("ol");

    for ( i=0; i<doc_ols.length; i++) {

        var ol_start = doc_ols[i].getAttribute("start") - 1;
        doc_ols[i].setAttribute("style", "counter-reset:ol_counter " + ol_start + ";");

    }

})();

        </script>
        <style>
            html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font:inherit;font-size:100%;vertical-align:baseline}html{line-height:1}ol,ul{list-style:none}table{border-collapse:collapse;border-spacing:0}caption,th,td{text-align:left;font-weight:normal;vertical-align:middle}q,blockquote{quotes:none}q:before,q:after,blockquote:before,blockquote:after{content:"";content:none}a img{border:none}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}*{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}html{font-size:87.5%;line-height:1.57143em}html{font-size:14px;line-height:1.6em;-webkit-text-size-adjust:100%}body{background:#fcfcfc;color:#545454;text-rendering:optimizeLegibility;font-family:"AvenirNext-Regular"}a{color:#de4c4f;text-decoration:none}h1{font-family:"AvenirNext-Medium";color:#333;font-size:1.6em;line-height:1.3em;margin-bottom:.78571em}h2{font-family:"AvenirNext-Medium";color:#333;font-size:1.3em;line-height:1em;margin-bottom:.62857em}h3{font-family:"AvenirNext-Medium";color:#333;font-size:1.15em;line-height:1em;margin-bottom:.47143em}p{margin-bottom:1.57143em;hyphens:auto}hr{height:1px;border:0;background-color:#dedede;margin:-1px auto 1.57143em auto}ul,ol{margin-bottom:.31429em}ul ul,ul ol,ol ul,ol ol{margin-bottom:0px}ol{counter-reset:ol_counter}ol li:before{content:counter(ol_counter) ".";counter-increment:ol_counter;color:#e06e73;text-align:right;display:inline-block;min-width:1em;margin-right:0.5em}b,strong{font-family:"AvenirNext-Bold"}i,em{font-family:"AvenirNext-Italic"}code{font-family:"Menlo-Regular"}.text-overflow-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.sf_code_string,.sf_code_selector,.sf_code_attr-name,.sf_code_char,.sf_code_builtin,.sf_code_inserted{color:#D33905}.sf_code_comment,.sf_code_prolog,.sf_code_doctype,.sf_code_cdata{color:#838383}.sf_code_number,.sf_code_boolean{color:#0E73A2}.sf_code_keyword,.sf_code_atrule,.sf_code_rule,.sf_code_attr-value,.sf_code_function,.sf_code_class-name,.sf_code_class,.sf_code_regex,.sf_code_important,.sf_code_variable,.sf_code_interpolation{color:#0E73A2}.sf_code_property,.sf_code_tag,.sf_code_constant,.sf_code_symbol,.sf_code_deleted{color:#1B00CE}.sf_code_macro,.sf_code_entity,.sf_code_operator,.sf_code_url{color:#920448}.note-wrapper{max-width:46em;margin:0px auto;padding:1.57143em 3.14286em}.note-wrapper.spotlight-preview{overflow-x:hidden}u{text-decoration:none;background-image:linear-gradient(to bottom, rgba(0,0,0,0) 50%,#e06e73 50%);background-repeat:repeat-x;background-size:2px 2px;background-position:0 1.05em}s{color:#878787}p{margin-bottom:0.1em}hr{margin-bottom:0.7em;margin-top:0.7em}ul li{text-indent:-0.35em}ul li:before{content:"•";color:#e06e73;display:inline-block;margin-right:0.3em}ul ul{margin-left:1.25714em}ol li{text-indent:-1.45em}ol ol{margin-left:1.25714em}blockquote{display:block;margin-left:-1em;padding-left:0.8em;border-left:0.2em solid #e06e73}.todo-list ul{margin-left:1.88571em}.todo-list li{text-indent:-1.75em}.todo-list li:before{content:"";display:static;margin-right:0px}.todo-checkbox{text-indent:-1.7em}.todo-checkbox svg{margin-right:0.3em;position:relative;top:0.2em}.todo-checkbox svg #check{display:none}.todo-checkbox.todo-checked #check{display:inline}.todo-checkbox.todo-checked+.todo-text{text-decoration:line-through;color:#878787}.code-inline{display:inline;background:white;border:solid 1px #dedede;padding:0.2em 0.5em;font-size:0.9em}.code-multiline{display:block;background:white;border:solid 1px #dedede;padding:0.7em 1em;font-size:0.9em;overflow-x:auto}.hashtag{display:inline-block;color:white;background:#b8bfc2;padding:0.0em 0.5em;border-radius:1em;text-indent:0}.hashtag a{color:#fff}.address a{color:#545454;background-image:linear-gradient(to bottom, rgba(0,0,0,0) 50%,#0da35e 50%);background-repeat:repeat-x;background-size:2px 2px;background-position:0 1.05em}.address svg{position:relative;top:0.2em;display:inline-block;margin-right:0.2em}.color-preview{display:inline-block;width:1em;height:1em;border:solid 1px rgba(0,0,0,0.3);border-radius:50%;margin-right:0.1em;position:relative;top:0.2em;white-space:nowrap}.color-code{margin-right:0.2em;font-family:"Menlo-Regular";font-size:0.9em}.color-hash{opacity:0.4}.ordered-list-number{color:#e06e73;text-align:right;display:inline-block;min-width:1em}.arrow svg{position:relative;top:0.08em;display:inline-block;margin-right:0.15em;margin-left:0.15em}.arrow svg #rod{stroke:#545454}.arrow svg #point{fill:#545454}mark{color:inherit;display:inline;padding:0.2em 0.5em;background-color:#fcffc0}img{max-width:100%;height:auto}

        </style>
    </body>
</html>
